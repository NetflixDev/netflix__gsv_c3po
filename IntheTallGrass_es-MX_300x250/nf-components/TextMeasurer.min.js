
/* wc-netflix-cta:TextMeasurer.min.js, VERSION: 7.0.1, Published: 2019/09/10 16:06:45 $*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).TextMeasurer=e()}(this,function(){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=["fontFamily","fontWeight","fontSize"];function h(t){return t.reduce(function(t,e){return t+e})}function d(t){for(var e,i=t.data,n=(t.height,4*t.width),a=0,h=0,o=3,r=i.length;o<r;o+=4){var s=Math.floor(o/n),c=i[o];0<c&&(void 0===e&&(e=s),h+=c*(s+.5),a+=c)}return void 0===e&&(e=0),{center:h/a,bottomY:u(t),topY:e}}function v(t){t.data,t.height,t.width;var e=o(t),i=u(t);return{center:Math.round((e+i)/2),bottomY:i,topY:e}}function o(t){for(var e=t.data,i=(t.height,4*t.width),n=3,a=e.length;n<a;n+=4){var h=Math.floor(n/i);if(0<e[n])return h}return 0}function u(t){for(var e=t.data,i=t.height,n=4*t.width,a=e.length-1;0<a;a-=4){var h=Math.floor(a/n);if(0<e[a])return h}return i-1}return function(){function l(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.fontFamily,i=void 0===e?"Times":e,n=t.fontWeight,a=void 0===n?"normal":n,h=t.fontSize,o=void 0===h?200:h,r=t.canvasHeight,s=t._centerText,c=void 0!==s&&s,u=t._bgColor,f=t._textColor;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),this.canvasHeight=r,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.text="",this._centerText=c,this._bgColor=u,this._textColor=f,this.updateFont({fontFamily:i,fontWeight:a,fontSize:o}),this._initializeCanvas(this.text)}return function(t,e,i){e&&n(t.prototype,e),i&&n(t,i)}(l,[{key:"updateFont",value:function(){var e=this,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=Object.keys(i).filter(function(t){return a.includes(t)});t.length&&t.forEach(function(t){i[t]&&("fontSize"===i[t]?e[t]=parseInt(i[t],10):e[t]=i[t])})}},{key:"_initializeCanvas",value:function(t){this.canvas.width=this.fontSize*t.length;var e=Math.round(.2*this.fontSize),i=this.fontSize+2*e;this.canvasHeight&&this.canvasHeight>=i?(this.canvas.height=this.canvasHeight,this.pad=Math.round((this.canvasHeight-this.fontSize)/2)):(this.pad=e,this.canvas.height=i),this._center=this.canvas.height/2,this.context.font="".concat(this.fontWeight," ").concat(this.fontSize,"px ").concat(this.fontFamily),this.context.textBaseline="top",this.context.textAlign="center"}},{key:"renderText",value:function(t){var e=this.canvas,i=this.context;t!==this.text&&(delete this._topY,delete this._bottomY,delete this._centerY,this.text=t||this.text,this._initializeCanvas(this.text),i.clearRect(0,0,e.width,e.height),i.fillText(this.text,Math.round(e.width/2),this.pad,e.width),this.imageData=i.getImageData(0,0,e.width,e.height))}},{key:"_calcMetric",value:function(t,e,i){return(!this.imageData||t&&t!==this.text)&&this.renderText(t),void 0===this[e]&&(this[e]=i(this.imageData)),this[e]}},{key:"calcTopY",value:function(t){return this._calcMetric(t,"_topY",o)}},{key:"calcBottomY",value:function(t){return this._calcMetric(t,"_bottomY",u)}},{key:"calcCenterY",value:function(t,e){var i=e.useCenterOfMass,n=void 0!==i&&i;return this._calcMetric(t,"_centerY",n?d:v)}},{key:"getCenterOfText",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=e.centerText,n=void 0!==i&&i,a=e.useCenterOfMass,h=void 0===a||a,o=e.usePerChar,r=void 0!==o&&o,s=this.canvas,c=this.context;c.clearRect(0,0,s.width,s.height),this.text=t||this.text,this._initializeCanvas(this.text);var u,f=h?d:v;r?u=this.getAvgOfPerLetterMedian(this.text,f):(c.fillText(this.text,Math.round(s.width/2),this.pad,s.width),u=f(c.getImageData(0,0,s.width,s.height)));if(this._center=u.center,this._topY=u.topY,this._bottomY=u.bottomY,n||this._bgColor||this._textColor){var l=n?s.height/2-this._center:0;this._bgColor?(c.fillStyle=this._bgColor,c.fillRect(0,0,s.width,s.height)):c.clearRect(0,0,s.width,s.height),this._textColor&&(c.fillStyle=this._textColor),c.fillText(this.text,Math.round(s.width/2),this.pad+l,s.width)}return this._center}},{key:"getCenteringOffset",value:function(t,e){var i=this.getCenterOfText(t,e);context.fillText(this.text,Math.round(canvas.width/2),this.pad,canvas.width),this.imageData=context.getImageData(0,0,canvas.width,canvas.height);(useCenterOfMass?d:v)(this.imageData);return this.canvas.height/2-i}},{key:"getCenterHeightPercentage",value:function(t,e){var i=this.getCenterOfText(t,e),n=this.pad;return(i-n)/(this.canvas.height-this.pad-n)}},{key:"getAvgOfPerLetterMedian",value:function(t,n){var a=this,e=Array.prototype.filter.call(t,function(t){return!/\s/.test(t)}).map(function(t){a._initializeCanvas(t),a.context.fillText(t,Math.round(a.canvas.width/2),a.pad,a.canvas.width);var e=a.context.getImageData(0,0,a.canvas.width,a.canvas.height),i=n(e);return i.width=a.canvas.width,i});this._initializeCanvas(t);var i=h(e.map(function(t){return t.width}));return{center:h(e.map(function(t){return t.center*t.width}))/i,topY:e.reduce(function(t,e){return Math.min(t,e.top)},1/0),bottomY:e.reduce(function(t,e){return Math.max(t,e.bottom)},-1/0)}}}]),l}()});
